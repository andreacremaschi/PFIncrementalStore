<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>PFIncrementalStore by sbonami</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>PFIncrementalStore</h1>
        <h2>Drop-in Core Data + Parse Persistence</h2>
        <a href="https://github.com/sbonami/PFIncrementalStore" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h2>
<a name="welcome-to-pfincrementalstore" class="anchor" href="#welcome-to-pfincrementalstore"><span class="octicon octicon-link"></span></a>Welcome to PFIncrementalStore</h2>

<p>This drop-in class manages persistence syncing between Core Data and Parse seamlessly. PFIncrementalStore is an
<a href="http://nshipster.com/nsincrementalstore/"><code>NSIncrementalStore</code></a>
subclass that uses
<a href="https://www.parse.com">Parse</a> to
automatically request resources as properties and relationships are
needed.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<h3>
<a name="requirements" class="anchor" href="#requirements"><span class="octicon octicon-link"></span></a>Requirements</h3>

<p>PFIncrementalStore requires a subscription to Parse, a valid Parse App, API
Key and Secret, and minor programming knowledge. Parse subscription and
API information can be obtained at
<a href="https://www.parse.com/">https://www.parse.com/</a></p>

<p>PFIncrementalStore requires Xcode 4.4 with the <a href="http://developer.apple.com/library/ios/#releasenotes/General/WhatsNewIniPhoneOS/Articles/iOS5.html">iOS
5.0</a>
SDK, as well as <a href="https://www.parse.com/downloads/ios/parse-library/latest">Parse</a> 1.2 or
higher.</p>

<h3>
<a name="cocoapods" class="anchor" href="#cocoapods"><span class="octicon octicon-link"></span></a>Cocoapods</h3>

<p><a href="http://cocoapods.org">CocoaPods</a> is the recommended way to add
PFIncrementalStore to your project.</p>

<p>Here's an example podfile that installs PFIncrementalStore and its
dependency, Parse:</p>

<h3>
<a name="podfile" class="anchor" href="#podfile"><span class="octicon octicon-link"></span></a>Podfile</h3>

<div class="highlight highlight-ruby"><pre><span class="n">platform</span> <span class="ss">:ios</span><span class="p">,</span> <span class="s1">'5.0'</span>

<span class="n">pod</span> <span class="s1">'PFIncrementalStore'</span>
</pre></div>

<p>Note the specification of iOS 5.0 as the platform; leaving out the 5.0 will cause CocoaPods to fail with the following message:</p>

<blockquote>
<p>[!] PFIncrementalStore is not compatible with iOS 4.3.</p>
</blockquote>

<h3>
<a name="create-a-pfincrementalstore-subclass" class="anchor" href="#create-a-pfincrementalstore-subclass"><span class="octicon octicon-link"></span></a>Create a PFIncrementalStore Subclass</h3>

<div class="highlight highlight-objective-c"><pre><span class="cp">#import &lt;PFIncrementalStore/PFIncrementalStore.h&gt;</span>

<span class="k">@interface</span> <span class="nc">IncrementalStore</span> : <span class="nc">PFIncrementalStore</span>

<span class="k">+</span> <span class="p">(</span><span class="n">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nf">modelURL</span><span class="p">;</span>

<span class="k">@end</span>
</pre></div>

<div class="highlight highlight-objective-c"><pre><span class="cp">#import "IncrementalStore.h"</span>

<span class="k">@implementation</span> <span class="nc">IncrementalStore</span>

<span class="k">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">initialize</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">NSPersistentStoreCoordinator</span> <span class="n">registerStoreClass</span><span class="o">:</span><span class="n">self</span> <span class="n">forStoreType</span><span class="o">:</span><span class="p">[</span><span class="n">self</span> <span class="n">type</span><span class="p">]];</span>
<span class="p">}</span>

<span class="k">+</span> <span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nf">type</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">NSStringFromClass</span><span class="p">(</span><span class="n">self</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">+</span> <span class="p">(</span><span class="n">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nf">modelURL</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[[</span><span class="n">NSBundle</span> <span class="n">mainBundle</span><span class="p">]</span> <span class="n">URLForResource</span><span class="o">:</span><span class="s">@"CoreDataModel"</span> <span class="n">withExtension</span><span class="o">:</span><span class="s">@"momd"</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">+</span> <span class="p">(</span><span class="n">NSManagedObjectModel</span> <span class="o">*</span><span class="p">)</span><span class="nf">model</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[[</span><span class="n">NSManagedObjectModel</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">initWithContentsOfURL</span><span class="o">:</span><span class="p">[</span><span class="n">self</span> <span class="n">modelURL</span><span class="p">]];</span>
<span class="p">}</span>

<span class="k">@end</span>
</pre></div>

<h3>
<a name="utilize-the-subclass-in-your-persistent-store-coordinator" class="anchor" href="#utilize-the-subclass-in-your-persistent-store-coordinator"><span class="octicon octicon-link"></span></a>Utilize the Subclass in your Persistent Store Coordinator</h3>

<div class="highlight highlight-objective-c"><pre><span class="k">-</span> <span class="p">(</span><span class="n">NSPersistentStoreCoordinator</span> <span class="o">*</span><span class="p">)</span><span class="nf">persistentStoreCoordinator</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">__persistentStoreCoordinator</span> <span class="o">==</span> <span class="nb">nil</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSURL</span> <span class="o">*</span><span class="n">storeURL</span> <span class="o">=</span> <span class="p">[[</span><span class="n">self</span> <span class="n">applicationDocumentsDirectory</span><span class="p">]</span> <span class="n">URLByAppendingPathComponent</span><span class="o">:</span><span class="p">[</span><span class="n">NSString</span> <span class="n">stringWithFormat</span><span class="o">:</span><span class="s">@"%@.sqlite"</span><span class="p">,[</span><span class="n">self</span> <span class="n">coreDataStack</span><span class="p">]]];</span>

        <span class="n">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
        <span class="n">__persistentStoreCoordinator</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSPersistentStoreCoordinator</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">initWithManagedObjectModel</span><span class="o">:</span><span class="p">[</span><span class="n">IncrementalStore</span> <span class="n">model</span><span class="p">]];</span>

        <span class="n">IncrementalStore</span> <span class="o">*</span><span class="n">incrementalStore</span> <span class="o">=</span> <span class="p">(</span><span class="n">IncrementalStore</span> <span class="o">*</span><span class="p">)[</span><span class="n">__persistentStoreCoordinator</span> <span class="n">addPersistentStoreWithType</span><span class="o">:</span><span class="p">[</span><span class="n">IncrementalStore</span> <span class="n">type</span><span class="p">]</span>
                                                                                                                <span class="nl">configuration:</span><span class="nb">nil</span> <span class="n">URL</span><span class="o">:</span><span class="nb">nil</span> <span class="n">options</span><span class="o">:</span><span class="nb">nil</span> <span class="n">error</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>

        <span class="n">NSDictionary</span> <span class="o">*</span><span class="n">options</span> <span class="o">=</span> <span class="p">@{</span>
                                  <span class="n">NSInferMappingModelAutomaticallyOption</span> <span class="o">:</span> <span class="p">@(</span><span class="nb">YES</span><span class="p">),</span>
                                  <span class="nl">NSMigratePersistentStoresAutomaticallyOption:</span> <span class="p">@(</span><span class="nb">YES</span><span class="p">)</span>
                                  <span class="p">};</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">incrementalStore</span><span class="p">.</span><span class="n">backingPersistentStoreCoordinator</span> <span class="n">addPersistentStoreWithType</span><span class="o">:</span><span class="n">NSSQLiteStoreType</span> <span class="n">configuration</span><span class="o">:</span><span class="nb">nil</span> <span class="n">URL</span><span class="o">:</span><span class="n">storeURL</span> <span class="n">options</span><span class="o">:</span><span class="n">options</span> <span class="n">error</span><span class="o">:&amp;</span><span class="n">error</span><span class="p">])</span> <span class="p">{</span>
            <span class="n">NSLog</span><span class="p">(</span><span class="s">@"Unresolved error %@, %@"</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="p">[</span><span class="n">error</span> <span class="n">userInfo</span><span class="p">]);</span>

            <span class="n">abort</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">__persistentStoreCoordinator</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="make-sure-to-initialize-parse-with-your-keys-possibly-in-your-appdelegate" class="anchor" href="#make-sure-to-initialize-parse-with-your-keys-possibly-in-your-appdelegate"><span class="octicon octicon-link"></span></a>Make sure to initialize Parse with your Keys, possibly in your AppDelegate</h3>

<div class="highlight highlight-objective-c"><pre><span class="p">[</span><span class="n">Parse</span> <span class="n">setApplicationId</span><span class="o">:&lt;</span><span class="err">#</span> <span class="n">Parse</span> <span class="n">Application</span> <span class="n">ID</span> <span class="err">#</span><span class="o">&gt;</span>
              <span class="nl">clientKey:</span><span class="o">&lt;</span><span class="err">#</span> <span class="n">Parse</span> <span class="n">Client</span> <span class="n">Key</span> <span class="err">#</span><span class="o">&gt;</span><span class="p">];</span>
</pre></div>

<h2>
<a name="credits" class="anchor" href="#credits"><span class="octicon octicon-link"></span></a>Credits</h2>

<p>PFIncrementalStore was created by <a href="https://github.com/sbonami/">Scott
BonAmi</a> (<a href="https://twitter.com/snb828">@snb828</a>).</p>

<h2>
<a name="disclaimer" class="anchor" href="#disclaimer"><span class="octicon octicon-link"></span></a>Disclaimer</h2>

<p>PFIncrementalStore is not affiliated, associated, authorized,
endorsed by, or in any way officially connected with Parse.com,
Parse Inc., or any of its subsidiaries or its affiliates. The
official Parse web site is available at <a href="https://www.parse.com">www.parse.com</a>. </p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/sbonami/PFIncrementalStore/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/sbonami/PFIncrementalStore/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/sbonami/PFIncrementalStore"></a> is maintained by <a href="https://github.com/sbonami">sbonami</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>